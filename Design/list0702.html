<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NH Order - Growth UI Simulator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;600;700;800&display=swap');
        
        :root {
            --nh-green: #1faa5e;
            --nh-dark: #178d4e;
            --bg-total: #f1f5f9;
            --bg-list: #ffffff;
        }

        body { font-family: 'Pretendard', sans-serif; background-color: #e2e8f0; color: #1e293b; overflow: hidden; -webkit-tap-highlight-color: transparent; }

        /* Mobile Container */
        .app-frame {
            width: 100%; height: 100%; max-width: 480px; margin: 0 auto;
            background: white; position: relative; overflow: hidden;
            display: flex; flex-direction: column; box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        /* Utility */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .touch-action-none { touch-action: none; }

        /* Header */
        header { flex-shrink: 0; height: 56px; border-bottom: 1px solid #e2e8f0; background: white; z-index: 50; display: flex; align-items: center; justify-content: space-between; padding: 0 16px; }
        
        .mode-switch-btn {
            background: #f0fdf4; border: 1px solid #dcfce7; color: var(--nh-green);
            padding: 6px 12px; border-radius: 20px; font-size: 13px; font-weight: 800;
            display: flex; align-items: center; gap: 6px; transition: all 0.2s;
        }
        .mode-switch-btn:active { transform: scale(0.95); background: #dcfce7; }

        /* Adaptive Tabs */
        .tab-track {
            flex-shrink: 0; height: 50px; background: white; border-bottom: 1px solid #e2e8f0;
            display: flex; align-items: center; overflow-x: auto; z-index: 40;
        }
        .tab-item {
            flex-shrink: 0; height: 100%; padding: 0 14px; display: flex; align-items: center; justify-content: center;
            font-size: 14px; font-weight: 600; color: #64748b; cursor: pointer; transition: color 0.2s; white-space: nowrap; position: relative;
        }
        .tab-item.active { color: var(--nh-green); font-weight: 800; }
        .tab-item.active::after {
            content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 3px; background: var(--nh-green);
        }
        .tab-manage {
            margin-left: auto; border-left: 1px solid #f1f5f9; background: #f8fafc; color: #475569;
        }

        /* Content Area */
        .content-area { flex: 1; overflow-y: auto; position: relative; transition: background-color 0.3s; scroll-behavior: smooth; }
        .bg-total-mode { background-color: var(--bg-total); }
        .bg-list-mode { background-color: var(--bg-list); }

        /* Product Cards */
        .card { transition: transform 0.2s; }
        .card:active { transform: scale(0.99); }
        
        /* Mall Home Specific */
        .mall-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 16px; }
        .mall-cat-bar { display: flex; justify-content: space-around; padding: 12px 0; background: white; border-bottom: 1px solid #f1f5f9; }

        /* Bottom Bar */
        .bottom-bar {
            flex-shrink: 0; height: 70px; background: white; border-top: 1px solid #e2e8f0;
            display: flex; align-items: center; padding: 0 16px; gap: 12px; z-index: 50; padding-bottom: env(safe-area-inset-bottom);
        }
        .action-btn {
            flex: 1; height: 50px; background: var(--nh-green); color: white; border-radius: 14px;
            font-weight: 800; font-size: 15px; display: flex; flex-direction: column; align-items: center; justify-content: center;
            box-shadow: 0 4px 10px rgba(31, 170, 94, 0.2); transition: all 0.2s;
        }
        .action-btn:active { transform: translateY(1px); background: var(--nh-dark); }

        /* Demo Controls */
        .demo-panel {
            position: absolute; bottom: 90px; right: 16px; background: rgba(30, 41, 59, 0.9);
            padding: 12px; border-radius: 16px; backdrop-filter: blur(4px); z-index: 100;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2); display: flex; flex-direction: column; gap: 8px;
            transform: translateX(120%); transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .demo-panel.open { transform: translateX(0); }
        .demo-toggle {
            position: absolute; bottom: 90px; right: 16px; width: 44px; height: 44px;
            background: #334155; color: white; border-radius: 50%; display: flex;
            align-items: center; justify-content: center; cursor: pointer; z-index: 101;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3); font-size: 20px;
        }

        /* Toast */
        .toast {
            position: absolute; bottom: 100px; left: 50%; transform: translate(-50%, 20px);
            background: rgba(15, 23, 42, 0.9); color: white; padding: 10px 20px;
            border-radius: 30px; font-size: 13px; font-weight: 600; opacity: 0; pointer-events: none;
            transition: all 0.3s; z-index: 200; white-space: nowrap; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .toast.show { opacity: 1; transform: translate(-50%, 0); }

        /* Coachmark */
        .coachmark {
            position: absolute; top: 110px; left: 50%; transform: translateX(-50%);
            background: #1e293b; color: #fff; padding: 8px 16px; border-radius: 20px;
            font-size: 12px; font-weight: 600; opacity: 0; transition: opacity 0.3s; pointer-events: none;
            display: flex; align-items: center; gap: 6px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); z-index: 60;
        }
        .coachmark::after {
            content: ''; position: absolute; top: -6px; left: 50%; transform: translateX(-50%);
            border-width: 0 6px 6px 6px; border-style: solid; border-color: transparent transparent #1e293b transparent;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen bg-slate-100">

    <div class="app-frame">
        <!-- Header -->
        <header>
            <button class="mode-switch-btn" onclick="toggleMode()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" id="modeIcon">
                    <!-- Dynamic Icon -->
                </svg>
                <span id="modeText">ì£¼ë¬¸í™ˆ</span>
            </button>
            <h1 class="text-lg font-extrabold text-slate-800 tracking-tight">NHë¼ì¸</h1>
            <div class="flex items-center gap-1 cursor-pointer" onclick="showToast('ë§¤ì¥ ë³€ê²½ ê¸°ëŠ¥')">
                <span class="text-xs font-bold text-slate-500">ê°•ë‚¨ 1í˜¸ì </span>
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#64748b" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
            </div>
        </header>

        <!-- Order Mode Tab Bar -->
        <div id="orderTabBar" class="tab-track no-scrollbar">
            <!-- Dynamic Content -->
        </div>

        <!-- Mall Mode Category Bar -->
        <div id="mallTabBar" class="hidden flex-col bg-white border-b border-slate-100">
            <div class="mall-cat-bar">
                <div class="flex flex-col items-center gap-1 cursor-pointer" onclick="showToast('ì±„ì†Œ/ê³¼ì¼')"><div class="w-10 h-10 bg-slate-50 rounded-xl flex items-center justify-center text-xl">ğŸ¥¬</div><span class="text-[10px] font-bold text-slate-500">ì±„ì†Œ/ê³¼ì¼</span></div>
                <div class="flex flex-col items-center gap-1 cursor-pointer" onclick="showToast('ì •ìœ¡/ìˆ˜ì‚°')"><div class="w-10 h-10 bg-slate-50 rounded-xl flex items-center justify-center text-xl">ğŸ¥©</div><span class="text-[10px] font-bold text-slate-500">ì •ìœ¡/ìˆ˜ì‚°</span></div>
                <div class="flex flex-col items-center gap-1 cursor-pointer" onclick="showToast('ê°€ê³µì‹í’ˆ')"><div class="w-10 h-10 bg-slate-50 rounded-xl flex items-center justify-center text-xl">ğŸ¥«</div><span class="text-[10px] font-bold text-slate-500">ê°€ê³µì‹í’ˆ</span></div>
                <div class="flex flex-col items-center gap-1 cursor-pointer" onclick="showToast('ì†ŒìŠ¤/ì–‘ë…')"><div class="w-10 h-10 bg-slate-50 rounded-xl flex items-center justify-center text-xl">ğŸ§‚</div><span class="text-[10px] font-bold text-slate-500">ì†ŒìŠ¤/ì–‘ë…</span></div>
                <div class="flex flex-col items-center gap-1 cursor-pointer" onclick="showToast('ì£¼ë°©/ì¡í™”')"><div class="w-10 h-10 bg-slate-50 rounded-xl flex items-center justify-center text-xl">ğŸ¥£</div><span class="text-[10px] font-bold text-slate-500">ì£¼ë°©/ì¡í™”</span></div>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area bg-total-mode" id="contentArea">
            
            <!-- Order Home Views -->
            <div id="orderView">
                <div id="productList" class="pb-6"></div>
            </div>

            <!-- Mall Home View -->
            <div id="mallView" class="hidden">
                <div class="p-4">
                    <div class="w-full h-40 rounded-2xl bg-gradient-to-br from-green-500 to-emerald-600 relative overflow-hidden shadow-lg p-6 flex flex-col justify-center text-white mb-6">
                        <h3 class="text-xl font-extrabold leading-tight mb-2">NHë¼ì¸ ì‚°ì§€ì§ì†¡<br>í”„ë¦¬ë¯¸ì—„ ê¸°íšì „</h3>
                        <p class="text-xs font-medium opacity-90">ì§€ê¸ˆ ê°€ì¥ ì‹ ì„ í•œ ì‹ì¬ë£Œë¥¼<br>ë§Œë‚˜ë³´ì„¸ìš”</p>
                        <div class="absolute -right-2 -bottom-4 text-8xl opacity-20">ğŸ“¦</div>
                    </div>

                    <div class="flex justify-between items-end mb-4">
                        <h3 class="text-lg font-bold text-slate-800">ì˜¤ëŠ˜ì˜ ì¶”ì²œ ìƒí’ˆ</h3>
                        <span class="text-xs font-bold text-slate-400">ì „ì²´ë³´ê¸° ></span>
                    </div>

                    <div class="mall-grid">
                        <!-- Mall Items -->
                        <div class="border border-slate-100 rounded-xl p-3 bg-white card">
                            <div class="w-full aspect-square bg-slate-50 rounded-lg mb-3 flex items-center justify-center text-4xl">ğŸ…</div>
                            <div class="text-xs font-bold text-slate-800 mb-1 line-clamp-2 h-8">ëŒ€ì € ì§­ì§¤ì´ í† ë§ˆí†  2.5kg</div>
                            <div class="flex items-center gap-1">
                                <span class="text-xs font-bold text-red-500">10%</span>
                                <span class="text-sm font-extrabold text-slate-900">24,900</span>
                            </div>
                        </div>
                        <div class="border border-slate-100 rounded-xl p-3 bg-white card">
                            <div class="w-full aspect-square bg-slate-50 rounded-lg mb-3 flex items-center justify-center text-4xl">ğŸ—</div>
                            <div class="text-xs font-bold text-slate-800 mb-1 line-clamp-2 h-8">êµ­ë‚´ì‚° ë‹­ë³¶ìŒíƒ•ìš© 1kg</div>
                            <div class="flex items-center gap-1">
                                <span class="text-xs font-bold text-red-500">15%</span>
                                <span class="text-sm font-extrabold text-slate-900">8,500</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Coachmark Overlay -->
        <div class="coachmark" id="sortCoachmark">
            <span id="cmIcon">â†—</span>
            <span id="cmText">ë“±ë¡í•œ ìµœì‹ ìˆœìœ¼ë¡œ ì •ë ¬í•©ë‹ˆë‹¤</span>
        </div>

        <!-- Bottom Bar -->
        <div class="bottom-bar">
            <button class="w-12 h-12 rounded-xl border border-slate-200 flex items-center justify-center text-slate-500" onclick="showToast('ê²€ìƒ‰ ê¸°ëŠ¥')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            </button>
            <button class="action-btn" id="mainActionBtn" onclick="handleMainAction()">
                <span class="text-[9px] opacity-80 mb-0.5 font-sans">ORDERZ</span>
                <span class="text-sm" id="actionBtnText">ìƒí’ˆì„ ë‹´ì•„ì£¼ì„¸ìš”</span>
            </button>
            <button class="w-12 h-12 rounded-xl border border-slate-200 flex items-center justify-center text-slate-500" onclick="showToast('1:1 ë¬¸ì˜')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
            </button>
        </div>

        <!-- Demo Settings Toggle -->
        <div class="demo-toggle" onclick="toggleDemoPanel()">âš™ï¸</div>
        <div class="demo-panel" id="demoPanel">
            <div class="text-xs font-bold text-slate-400 mb-1 px-1">ë¦¬ìŠ¤íŠ¸ ê°œìˆ˜ ì‹œë®¬ë ˆì´ì…˜</div>
            <div class="flex gap-2">
                <button onclick="setListCount(0)" class="px-3 py-1.5 bg-slate-700 text-white rounded-lg text-xs font-bold">0ê°œ</button>
                <button onclick="setListCount(1)" class="px-3 py-1.5 bg-slate-700 text-white rounded-lg text-xs font-bold">1ê°œ</button>
                <button onclick="setListCount(2)" class="px-3 py-1.5 bg-slate-700 text-white rounded-lg text-xs font-bold">2ê°œ</button>
                <button onclick="setListCount(3)" class="px-3 py-1.5 bg-slate-700 text-white rounded-lg text-xs font-bold">3ê°œ</button>
            </div>
        </div>

        <!-- Toast Message -->
        <div class="toast" id="toast">ë©”ì‹œì§€ ë‚´ìš©</div>
    </div>

    <script>
        // --- State Management ---
        const state = {
            mode: 'order', // 'order' or 'mall'
            listCount: 0,  // 0 ~ 3 (Growth Stage)
            activeTab: 'total', // 'special', 'total', 'list1', 'list2', 'list3'
            totalSort: 'latest', // 'latest' or 'category'
        };

        // --- Mock Data ---
        const products = [
            { id: 1, name: "ì‹ ì„  ì–‘ë°°ì¶” íŠ¹ìƒ (3ì…)", price: 10900, img: "ğŸ¥¦", category: "ì±„ì†Œ", list: ["LIST 1"], order: 1 },
            { id: 2, name: "ì œì£¼ í–‡ì‚¬ê³¼ 10kg ë°•ìŠ¤", price: 42000, img: "ğŸ", category: "ê³¼ì¼", list: ["LIST 1"], order: 2 },
            { id: 3, name: "CJ í–‡ë°˜ 210g x 24ì…", price: 21900, img: "ğŸš", category: "ê°€ê³µ", list: [], order: null }, // Only in Total
            { id: 4, name: "í•œìš° êµ­ê±°ë¦¬ 1ë“±ê¸‰ 500g", price: 35000, img: "ğŸ¥©", category: "ì •ìœ¡", list: ["LIST 2"], order: 1 },
            { id: 5, name: "ë™ì› ì°¸ì¹˜ ë¼ì´íŠ¸ 100g", price: 1800, img: "ğŸŸ", category: "ê°€ê³µ", list: ["LIST 2"], order: 2 }
        ];

        // --- Config: Adaptive UI Logic ---
        const tabConfig = {
            0: { spec: "â­ ë‹¨ê³¨íŠ¹ê°€", total: "ì „ì²´ìƒí’ˆ â†— ìµœì‹ ìˆœ ì •ë ¬", manage: "ë¦¬ìŠ¤íŠ¸ ë§Œë“¤ê¸°" },
            1: { spec: "â­ ë‹¨ê³¨íŠ¹ê°€", total: "ì „ì²´ìƒí’ˆ â†— ìµœì‹ ìˆœ", manage: "+" },
            2: { spec: "â­ ë‹¨ê³¨íŠ¹ê°€", total: "ì „ì²´ìƒí’ˆ â†—", manage: "+" },
            3: { spec: "â­", total: "ì „ì²´ â†—", manage: "+" } // Condensed for max space
        };

        // --- Initialization ---
        function init() {
            updateHeaderUI();
            renderTabs();
            renderContent();
        }

        // --- Core Functions ---

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.innerText = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2000);
        }
        
        function setListCount(count) {
            state.listCount = count;
            // If active tab is removed, reset to total
            if (state.activeTab.startsWith('list') && parseInt(state.activeTab.replace('list', '')) > count) {
                state.activeTab = 'total';
            }
            renderTabs();
            renderContent();
            showToast(`ë¦¬ìŠ¤íŠ¸ ê°œìˆ˜: ${count}ê°œ (UI ë‹¨ê³„ ë³€ê²½)`);
        }

        function toggleMode() {
            state.mode = state.mode === 'order' ? 'mall' : 'order';
            const isOrder = state.mode === 'order';
            
            updateHeaderUI();

            // Tabs
            document.getElementById('orderTabBar').style.display = isOrder ? 'flex' : 'none';
            document.getElementById('mallTabBar').style.display = isOrder ? 'none' : 'flex';

            // Content
            document.getElementById('orderView').style.display = isOrder ? 'block' : 'none';
            document.getElementById('mallView').style.display = isOrder ? 'none' : 'block';

            // Action Button
            document.getElementById('actionBtnText').innerText = isOrder ? 'ìƒí’ˆì„ ë‹´ì•„ì£¼ì„¸ìš”' : 'ì£¼ë¬¸í•˜ëŸ¬ ê°€ê¸°';
            
            // Reset BG
            if(isOrder) renderContent(); // Restore bg
            else document.getElementById('contentArea').className = 'content-area bg-white';

            showToast(isOrder ? 'ì£¼ë¬¸ ëª¨ë“œë¡œ ì „í™˜ë˜ì—ˆìŠµë‹ˆë‹¤' : 'ì‡¼í•‘ëª° ëª¨ë“œë¡œ ì „í™˜ë˜ì—ˆìŠµë‹ˆë‹¤');
        }

        function updateHeaderUI() {
            const isOrder = state.mode === 'order';
            document.getElementById('modeText').innerText = isOrder ? 'ì£¼ë¬¸í™ˆ' : 'ì‡¼í•‘ëª°í™ˆ';
            document.getElementById('modeIcon').innerHTML = isOrder 
                ? '<path d="M19 12H5M12 19l-7-7 7-7"></path>' // Back arrow
                : '<path d="M3 3h18v18H3zM12 8v8M8 12h8"/>'; // Mall icon
            document.querySelector('.mode-switch-btn').style.transform = "rotate(360deg)";
            setTimeout(() => document.querySelector('.mode-switch-btn').style.transform = "none", 300);
        }

        function renderTabs() {
            const container = document.getElementById('orderTabBar');
            container.innerHTML = '';
            
            const config = tabConfig[state.listCount];

            // 1. Special Tab
            const specTab = createTab(config.spec, 'special', state.activeTab === 'special');
            specTab.style.minWidth = state.listCount === 3 ? '40px' : 'auto';
            container.appendChild(specTab);

            // 2. Total Tab (Master)
            const totalTab = createTab(config.total, 'total', state.activeTab === 'total');
            // Add sort icon visual if active
            if(state.activeTab === 'total') {
                const icon = state.totalSort === 'latest' ? 'â†—' : 'â˜°';
                totalTab.innerHTML = config.total.replace('â†—', `<span style="background:#dcfce7; padding:2px 6px; border-radius:4px; margin:0 4px; color:#178d4e;">${icon}</span>`);
            }
            totalTab.onclick = () => handleTotalTabClick();
            container.appendChild(totalTab);

            // 3. Dynamic User Lists
            for(let i=1; i<=state.listCount; i++) {
                const listId = `list${i}`;
                const label = state.listCount >= 3 ? `L${i}` : `LIST ${i}`; // Abbreviate if many
                container.appendChild(createTab(label, listId, state.activeTab === listId));
            }

            // 4. Manage/Create Button (Always at end)
            const manageBtn = document.createElement('div');
            manageBtn.className = 'tab-item tab-manage';
            manageBtn.innerText = config.manage;
            if(state.listCount > 0) {
                manageBtn.style.fontSize = "20px";
                manageBtn.style.padding = "0 16px";
            }
            manageBtn.onclick = () => {
                // Simulate adding a list
                if(state.listCount < 3) setListCount(state.listCount + 1);
                else alert("ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬/í¸ì§‘ ëª¨ë‹¬ ì˜¤í”ˆ");
            };
            container.appendChild(manageBtn);
        }

        function createTab(text, id, isActive) {
            const div = document.createElement('div');
            div.className = `tab-item ${isActive ? 'active' : ''}`;
            div.innerHTML = text;
            div.onclick = () => selectTab(id);
            return div;
        }

        function selectTab(id) {
            state.activeTab = id;
            renderTabs();
            renderContent();
        }

        function handleTotalTabClick() {
            if (state.activeTab === 'total') {
                // Toggle Sort
                state.totalSort = state.totalSort === 'latest' ? 'category' : 'latest';
                renderTabs();
                renderContent();
                showCoachmark(state.totalSort === 'latest' ? 'â†— ë“±ë¡ìˆœ(ìµœì‹ ìˆœ) ì •ë ¬' : 'â˜° í’ˆëª© ì¹´í…Œê³ ë¦¬ìˆœ ì •ë ¬');
            } else {
                selectTab('total');
            }
        }

        function renderContent() {
            const listContainer = document.getElementById('productList');
            const contentArea = document.getElementById('contentArea');
            const actionText = document.getElementById('actionBtnText');
            listContainer.innerHTML = '';

            // Set Background & Context
            if (state.activeTab === 'total' || state.activeTab === 'special') {
                contentArea.className = 'content-area bg-total-mode';
                actionText.innerText = "ìƒí’ˆì„ ë‹´ì•„ì£¼ì„¸ìš”";
            } else {
                contentArea.className = 'content-area bg-list-mode';
                actionText.innerText = `${state.activeTab.toUpperCase()} ì£¼ë¬¸ ì „ì†¡`;
            }

            // Data Filtering & Sorting
            let data = [];
            if (state.activeTab === 'special') {
                // Mock Special
                data = [products[0], products[3]]; 
                listContainer.innerHTML = `<div class="p-4 text-xs font-bold text-red-500 flex items-center gap-2"><span class="w-1 h-4 bg-red-500 rounded-sm inline-block"></span>ì‚¬ì¥ë‹˜ ê°•ë ¥ ì¶”ì²œ</div>`;
            } else if (state.activeTab === 'total') {
                data = [...products];
                if (state.totalSort === 'category') data.sort((a,b) => a.category.localeCompare(b.category));
            } else {
                const listNum = state.activeTab.toUpperCase().replace('LIST', 'LIST '); // match mock data format
                data = products.filter(p => p.list.includes(listNum));
                data.sort((a,b) => a.order - b.order);
            }

            // Render Items
            if (data.length === 0 && state.activeTab.startsWith('list')) {
                listContainer.innerHTML = `
                    <div class="flex flex-col items-center justify-center py-20 text-center">
                        <div class="text-4xl mb-4 opacity-30">ğŸ“</div>
                        <p class="text-slate-400 text-sm">ì•„ì§ ë‹´ê¸´ ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤.<br>ì „ì²´ ëª©ë¡ì—ì„œ ìƒí’ˆì„ ì¶”ê°€í•´ë³´ì„¸ìš”.</p>
                        <button onclick="selectTab('total')" class="mt-4 px-4 py-2 bg-slate-200 rounded-lg text-xs font-bold text-slate-600">ìƒí’ˆ ë‹´ìœ¼ëŸ¬ ê°€ê¸°</button>
                    </div>
                `;
            } else {
                data.forEach((p, idx) => {
                    const isTotal = state.activeTab === 'total' || state.activeTab === 'special';
                    const badge = isTotal && p.list.length > 0 
                        ? `<span class="text-[10px] bg-green-50 text-green-700 px-1.5 py-0.5 rounded ml-1 font-bold tracking-tight">${p.list[0]}</span>` 
                        : '';
                    
                    const orderNum = !isTotal ? `<div class="w-8 text-lg font-black text-slate-300 italic mr-2 text-center">${idx+1}</div>` : '';

                    const div = document.createElement('div');
                    div.className = isTotal 
                        ? "bg-white m-3 p-4 rounded-xl border border-slate-200 shadow-sm flex items-center card"
                        : "bg-white px-4 py-5 border-b border-slate-100 flex items-center card";
                    
                    div.innerHTML = `
                        ${orderNum}
                        <div class="w-16 h-16 bg-slate-50 rounded-lg flex items-center justify-center text-3xl mr-4 flex-shrink-0">${p.img}</div>
                        <div class="flex-1 min-w-0">
                            <div class="text-[15px] font-bold text-slate-800 mb-1 truncate">${p.name}</div>
                            <div class="text-base font-extrabold text-slate-900">${p.price.toLocaleString()}ì›</div>
                            ${badge ? `<div class="mt-1">${badge}</div>` : ''}
                        </div>
                        <div class="w-11 h-11 border border-slate-200 rounded-lg flex items-center justify-center text-slate-300 font-bold active:bg-green-50 active:border-green-200 active:text-green-600 transition-colors cursor-pointer">+</div>
                    `;
                    listContainer.appendChild(div);
                });
            }
        }

        // --- Helpers ---
        function toggleDemoPanel() {
            document.getElementById('demoPanel').classList.toggle('open');
        }

        function showCoachmark(text) {
            const cm = document.getElementById('sortCoachmark');
            const icon = state.totalSort === 'latest' ? 'â†—' : 'â˜°';
            document.getElementById('cmIcon').innerText = icon;
            document.getElementById('cmText').innerText = text;
            cm.classList.add('show');
            setTimeout(() => {
                cm.classList.remove('show');
            }, 2000);
        }

        function handleMainAction() {
            if (state.mode === 'mall') toggleMode();
            else showToast('ì£¼ë¬¸ ì „ì†¡ í”„ë¡œì„¸ìŠ¤ ì‹œì‘');
        }

        window.onload = init;
    </script>
</body>
</html>
