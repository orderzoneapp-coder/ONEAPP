<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì˜¤ë”ì¦ˆ - ë¹ ë¥¸ì£¼ë¬¸ (ê³ ë„í™”)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        body {
            font-family: 'Noto Sans KR', sans-serif;
            overscroll-behavior-y: contain;
            -webkit-text-size-adjust: 100%;
            text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* íƒ­ ìŠ¤íƒ€ì¼ */
        .tab-btn {
            display: flex; align-items: center; justify-content: center;
            height: 100%; font-size: 0.875rem; white-space: nowrap;
            transition: all 0.2s; border-bottom: 2px solid transparent;
            padding: 0 1rem; flex-shrink: 0;
        }
        .tab-active { border-bottom-color: #22c55e; color: #16a34a; font-weight: 700; }
        .tab-inactive { color: #6b7280; font-weight: 500; }

        /* Create List Tab Style */
        .cl-tab-btn {
            flex: 1; text-align: center; padding: 0.75rem 0; font-size: 0.875rem;
            color: #6b7280; border-bottom: 2px solid transparent; font-weight: 500;
        }
        .cl-tab-btn.active { color: #16a34a; border-bottom-color: #16a34a; font-weight: 700; }

        /* Grid Layout */
        .cl-grid-row {
            display: grid; grid-template-columns: 40px 1fr 36px 36px 36px 30px;
            gap: 4px; padding: 12px 4px; background: #fff; border-bottom: 1px solid #f3f4f6; align-items: center;
        }
        .cl-grid-row.checked { background-color: #f0fdf4; }

        .cl-toggle-btn {
            width: 30px; height: 30px; margin: 0 auto; border-radius: 6px;
            border: 1px solid #e5e7eb; background: #fff; color: #d1d5db;
            font-size: 10px; font-weight: 700; display: flex; align-items: center; justify-content: center;
        }
        .cl-toggle-btn.active { background: #22c55e; border-color: #22c55e; color: white; }
        
        .cl-select-bar {
            display: flex; align-items: center; justify-content: space-between; padding: 10px 14px;
            background: #f9fafb; border-bottom: 1px solid #eee; font-size: 12px; color: #6b7280;
            position: sticky; top: 0; z-index: 10;
        }

        /* Accordion Styles */
        .accordion-header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 16px; background-color: #fff; border-bottom: 1px solid #f3f4f6;
            cursor: pointer; transition: background-color 0.2s;
        }
        .accordion-header:active { background-color: #f9fafb; }
        .accordion-content {
            max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out;
            background-color: #fff;
        }
        .accordion-item.active .accordion-content { max-height: 1000px; }
        .accordion-item.active .chevron-icon { transform: rotate(180deg); }
        .chevron-icon { transition: transform 0.2s; }

        /* Setting Radio Buttons */
        .setting-radio-group { display: flex; gap: 8px; margin-top: 8px; }
        .setting-radio-btn {
            flex: 1; padding: 12px; border: 1px solid #e5e7eb; border-radius: 12px;
            text-align: center; font-size: 13px; cursor: pointer; transition: all 0.2s; background: #fff;
        }
        .setting-radio-btn.active { border-color: #22c55e; background: #f0fdf4; color: #16a34a; font-weight: 700; }

        /* ë¦¬ìŠ¤íŠ¸ ì´ë¦„ ì…ë ¥ ê·¸ë£¹ */
        .list-input-group {
            border: 1px solid #e5e7eb; border-radius: 10px; padding: 8px 12px;
            transition: all 0.2s; background-color: #fff; display: flex; align-items: center;
        }
        .list-input-group.active {
            border-color: #22c55e; background-color: #f0fdf4; box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.1);
        }

        /* Keyword Pool */
        .keyword-chip {
            font-size: 11px; padding: 6px 12px; border-radius: 8px;
            background-color: #fff; color: #4b5563; border: 1px solid #e5e7eb;
            cursor: pointer; white-space: nowrap; transition: all 0.2s;
            box-shadow: 0 1px 2px rgba(0,0,0,0.03);
        }
        .keyword-chip:active { background-color: #e5e7eb; transform: scale(0.96); }

        /* Sub Section Bar Animation */
        .sub-section-bar {
            display: flex; justify-content: space-between; align-items: center;
            padding: 0.75rem 1rem; background-color: #fff; border-bottom: 1px solid #f3f4f6; font-size: 13px;
        }
        .sort-bar-transition { transition: max-height 0.3s ease-out, opacity 0.3s ease-out; max-height: 60px; opacity: 1; overflow: hidden; }
        .sort-bar-collapsed { max-height: 0; opacity: 0; padding: 0 !important; border: none; }
        .sort-bar-overflow-visible { overflow: visible !important; }

        .sort-dropdown-menu {
            position: absolute; top: 100%; right: 0; margin-top: 4px; background: white;
            border: 1px solid #e5e7eb; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            width: 140px; z-index: 50; display: none;
        }
        .sort-dropdown-menu.active { display: block; }
        .sort-option { padding: 10px 12px; font-size: 13px; color: #374151; cursor: pointer; border-bottom: 1px solid #f9fafb; }
        .sort-option:last-child { border-bottom: none; }
        .sort-option:hover { background-color: #f9fafb; }
        .sort-option.selected { color: #16a34a; font-weight: 700; }

        .add-list-btn-wide {
            font-size: 0.75rem; color: #22c55e; font-weight: 700; border: 1px solid #22c55e;
            padding: 4px 10px; border-radius: 12px; background: white; white-space: nowrap; flex-shrink: 0;
        }
        .search-hidden { max-height: 0; opacity: 0; padding: 0 !important; pointer-events: none; overflow: hidden; transition: all 0.3s; }
        .safe-pb { padding-bottom: env(safe-area-inset-bottom); }
    </style>
</head>
<body class="bg-gray-50">

    <div id="app" class="max-w-md mx-auto bg-white shadow-lg min-h-screen pb-20 relative overflow-hidden">

        <!-- HEADER -->
        <header class="sticky top-0 bg-white z-40 shadow-sm border-b">
            <div class="relative flex justify-between items-center p-3 h-[57px]">
                <!-- ì¢Œì¸¡ ë‚´ë¹„ê²Œì´ì…˜ ë²„íŠ¼ (í˜„ì¬ ìœ„ì¹˜ í‘œê¸° ë° ì´ë™ ê¸°ëŠ¥) -->
                <button id="mode-switch-btn" class="flex items-center space-x-1.5 text-gray-700 hover:bg-gray-100 rounded-lg px-2.5 py-1.5 transition">
                    <i id="mode-icon" class="fas fa-bars text-lg text-gray-400"></i>
                    <span id="mode-text" class="text-sm font-bold">ìƒí’ˆëª©ë¡</span>
                </button>

                <!-- NHë¼ì¸ ë¡œê³  (í™ˆ ì´ë™ ë° ìƒë‹¨ ìŠ¤í¬ë¡¤) -->
                <h1 id="header-title" class="absolute left-1/2 -translate-x-1/2 text-2xl font-black text-gray-700 cursor-pointer tracking-tight">NHë¼ì¸</h1>
                
                <div class="flex items-center space-x-2">
                    <span class="text-[10px] font-bold bg-gray-100 px-1.5 py-0.5 rounded text-gray-400">PRO</span>
                    <i class="fas fa-user-circle text-2xl text-gray-300"></i>
                </div>
            </div>
        </header>

        <!-- [HOME] ìƒí’ˆëª©ë¡ ë·° -->
        <main id="home-view" class="hidden">
             <div id="category-bar" class="flex justify-around items-center bg-white py-2 px-1 border-b sticky top-[57px] z-30">
                <button class="category-btn" onclick="filterByCategory('vegetable')">
                    <span class="text-2xl">ğŸ¥¬</span><span class="text-[10px] font-medium text-gray-600">ì±„ì†Œ.ê³¼ì¼</span>
                </button>
                <button class="category-btn" onclick="filterByCategory('seafood')">
                    <span class="text-2xl">ğŸ¥©</span><span class="text-[10px] font-medium text-gray-600">ìˆ˜ì‚°.ì¶•ì‚°</span>
                </button>
                <button class="category-btn" onclick="filterByCategory('processed')">
                    <span class="text-2xl">ğŸ¥¤</span><span class="text-[10px] font-medium text-gray-600">ì‹í’ˆ.ìŒë£Œ</span>
                </button>
                <button class="category-btn" onclick="filterByCategory('sauce')">
                    <span class="text-2xl">ğŸ§‚</span><span class="text-[10px] font-medium text-gray-600">ì–‘ë….ì†ŒìŠ¤</span>
                </button>
                <button class="category-btn" onclick="filterByCategory('kitchen')">
                    <span class="text-2xl">ğŸ¥£</span><span class="text-[10px] font-medium text-gray-600">ì£¼ë°©.ì¡í™”</span>
                </button>
             </div>
             <div class="flex justify-around items-center px-4 py-2 border-b bg-white">
                <button class="py-2 text-sm font-semibold border-b-2 border-green-500 text-green-500">íƒ€ì„ì„¸ì¼</button>
                <button class="py-2 text-sm text-gray-500">ê²½ë§¤ìƒí’ˆ</button>
                <button class="py-2 text-sm text-gray-500">í• ì¸ìƒí’ˆ</button>
                <button class="py-2 text-sm text-gray-500">ë§ˆê°ì„ë°•</button>
             </div>
             <div id="home-search-container" class="p-3 border-b bg-white search-hidden shadow-inner sticky top-[125px] z-30">
                <input type="text" id="home-search-input" placeholder="ì „ì²´ ìƒí’ˆ ê²€ìƒ‰" class="w-full pl-10 pr-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 text-sm bg-gray-50">
            </div>
             <div id="home-product-list" class="divide-y pb-24"></div>
        </main>

        <!-- [ORDER] ì£¼ë¬¸í•˜ê¸° ë·° -->
        <main id="quick-order-view" class="hidden">
            <div id="sub-header" class="sticky top-[57px] z-30 shadow-md bg-gray-100 relative">
                <div id="my-list-container" class="flex justify-between items-center px-0 bg-white border-b h-[40px] overflow-hidden">
                    <div id="my-list-tabs" class="flex flex-1 items-center h-full no-scrollbar overflow-x-auto"></div>
                </div>
                <div id="sub-section-bar" class="sub-section-bar hidden sort-bar-transition">
                    <div class="delivery-btn flex items-center gap-1 font-bold text-gray-700" onclick="alert('ë°°ì†¡ì¼ ë³€ê²½ ì‹œíŠ¸')">
                        <i class="far fa-calendar-alt text-green-600"></i><span id="current-delivery-date">1ì›” 12ì¼(ì›”) ë„ì°©</span>
                    </div>
                    <div class="sort-dropdown-container relative">
                        <div class="sort-btn flex items-center gap-1 text-gray-500 font-medium cursor-pointer" onclick="toggleSortDropdown(event)">
                            <span id="current-sort-label">ìµœì‹ ìˆœ</span><i class="fas fa-caret-down text-gray-400"></i>
                        </div>
                        <div id="sort-dropdown-menu" class="sort-dropdown-menu">
                            <div class="sort-option" onclick="changeSort('latest')">ìµœì‹ ìˆœ</div>
                            <div class="sort-option" onclick="changeSort('category')">ì¹´í…Œê³ ë¦¬ìˆœ</div>
                            <div class="sort-option" onclick="changeSort('frequency')">ìì£¼ ì“°ëŠ” ìƒí’ˆìˆœ</div>
                        </div>
                    </div>
                </div>
                <div id="search-container" class="p-3 border-b bg-white search-hidden shadow-inner">
                    <input type="text" id="product-search-input" placeholder="ë‹´ì€ ìƒí’ˆ ë‚´ ê²€ìƒ‰" class="w-full pl-10 pr-4 py-2.5 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 text-sm bg-gray-50">
                </div>
            </div>
            <div id="product-list-container" class="pb-24">
                <div id="product-list" class="bg-white border-t"></div>
            </div>
        </main>

        <!-- [EDIT] ë¦¬ìŠ¤íŠ¸ ë§Œë“¤ê¸° ë·° -->
        <div id="create-list-view" class="hidden absolute inset-0 bg-white z-50 flex flex-col">
            <header class="flex-none flex justify-between items-center px-4 h-[57px] border-b bg-white shadow-sm z-20">
                <button id="create-list-close-icon" class="text-gray-400" onclick="closeCreateListView()"><i class="fas fa-times text-xl"></i></button>
                <h1 class="text-lg font-bold">ë¦¬ìŠ¤íŠ¸ ë§Œë“¤ê¸°</h1>
                <button id="create-list-save-btn" class="text-green-600 font-bold text-sm" onclick="saveCreateListChanges()">ì €ì¥</button>
            </header>
            <div class="flex-none flex border-b bg-white z-20">
                <button class="cl-tab-btn active" data-tab="all">ì „ì²´</button>
                <button class="cl-tab-btn" data-tab="1" id="cl-tab-l1">ë¦¬ìŠ¤íŠ¸1</button>
                <button class="cl-tab-btn" data-tab="2" id="cl-tab-l2">ë¦¬ìŠ¤íŠ¸2</button>
                <button class="cl-tab-btn" data-tab="3" id="cl-tab-l3">ë¦¬ìŠ¤íŠ¸3</button>
            </div>
            <div class="flex-grow overflow-y-auto bg-gray-50 pb-24">
                <div class="cl-select-bar">
                    <div class="flex items-center">
                        <input type="checkbox" id="cl-select-all" class="w-5 h-5 rounded border-gray-300 accent-green-600 mr-2">
                        ì „ì²´ ì„ íƒ <span id="cl-selected-count" class="text-green-600 font-bold ml-1">(0)</span>
                    </div>
                    <button class="flex items-center gap-1 border border-gray-200 px-3 py-1.5 rounded-full bg-white text-[11px] font-bold text-gray-500 shadow-sm" onclick="openGuide()">
                        <i class="fas fa-cog text-gray-300"></i> ì´ìš©ì•ˆë‚´ ë° ì„¤ì •
                    </button>
                </div>
                <div id="create-list-items" class="divide-y divide-gray-100"></div>
            </div>
            <div class="absolute bottom-0 left-0 right-0 bg-white border-t p-3 flex gap-2 z-30 safe-pb">
                <button id="cl-bottom-back" class="flex-1 py-3 border rounded-lg text-gray-600 font-bold" onclick="closeCreateListView()">ë’¤ë¡œ</button>
                <button id="cl-bottom-delete" class="flex-1 py-3 border border-red-200 rounded-lg text-red-500 font-bold bg-red-50" disabled>ì‚­ì œ</button>
                <button id="cl-bottom-move" class="flex-[1.5] py-3 rounded-lg text-white font-bold bg-green-600" disabled>ì´ë™</button>
            </div>
        </div>

        <!-- [MODAL] ì´ìš©ì•ˆë‚´ ë° ì„¤ì • (3ë‹¨ ì•„ì½”ë””ì–¸ êµ¬ì¡°) -->
        <div id="guide-modal-overlay" class="fixed inset-0 bg-black/50 z-[60] hidden flex items-center justify-center p-4">
            <div class="bg-white rounded-2xl w-full max-w-sm max-h-[85vh] overflow-hidden flex flex-col shadow-2xl">
                <div class="flex justify-between items-center p-5 border-b bg-white sticky top-0">
                    <h3 class="text-lg font-bold">ì´ìš© ê°€ì´ë“œ ë° ì„¤ì •</h3>
                    <button onclick="closeGuide()" class="text-gray-400"><i class="fas fa-times"></i></button>
                </div>
                <div class="flex-grow overflow-y-auto bg-gray-50">
                    
                    <!-- 1. ì‹œì‘í™”ë©´ ì„¤ì • -->
                    <div class="accordion-item border-b active" id="acc-start-mode">
                        <div class="accordion-header" onclick="toggleAccordion('acc-start-mode')">
                            <h4 class="text-sm font-bold text-gray-800"><i class="fas fa-home text-blue-500 mr-2"></i> ì‹œì‘ í™”ë©´ ì„¤ì •</h4>
                            <i class="fas fa-chevron-down text-gray-400 chevron-icon"></i>
                        </div>
                        <div class="accordion-content">
                            <div class="p-5">
                                <p class="text-[11px] text-gray-500 mb-3">ì•±ì„ ì¬ì ‘ì†í–ˆì„ ë•Œ ì²˜ìŒ ë³´ì—¬ì§ˆ í™”ë©´ì„ ì„ íƒí•˜ì„¸ìš”.</p>
                                <div class="setting-radio-group">
                                    <div class="setting-radio-btn" id="radio-start-home" onclick="setStartMode('home')">ìƒí’ˆëª©ë¡</div>
                                    <div class="setting-radio-btn" id="radio-start-order" onclick="setStartMode('quick-order')">ì£¼ë¬¸í•˜ê¸°</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 2. ì‚¬ìš© ê°€ì´ë“œ -->
                    <div class="accordion-item border-b" id="acc-usage-guide">
                        <div class="accordion-header" onclick="toggleAccordion('acc-usage-guide')">
                            <h4 class="text-sm font-bold text-gray-800"><i class="fas fa-info-circle text-green-500 mr-2"></i> ì‚¬ìš© ê°€ì´ë“œ</h4>
                            <i class="fas fa-chevron-down text-gray-400 chevron-icon"></i>
                        </div>
                        <div class="accordion-content">
                            <div class="p-5">
                                <div class="bg-white rounded-xl border border-gray-100 p-4 text-[12px] text-gray-600 leading-relaxed shadow-sm">
                                    <p class="mb-3">ğŸ“Œ <strong>ë¦¬ìŠ¤íŠ¸ ë§Œë“¤ê¸°ë€?</strong><br>ì°œí•œ ìƒí’ˆë“¤ì„ 'ì£¼ë°©', 'ì°½ê³ ' ë“± ì‘ì—… ê³µê°„ë³„ë¡œ ë¶„ë¥˜í•˜ì—¬ ë” ë¹ ë¥´ê²Œ ì£¼ë¬¸í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.</p>
                                    <p class="mb-3">âœ”ï¸ <strong>ë¶„ë¥˜ ë°©ë²•:</strong><br>ìƒí’ˆ ìš°ì¸¡ì˜ [1], [2], [3] ë²„íŠ¼ì„ ëˆŒëŸ¬ í•´ë‹¹ ë¦¬ìŠ¤íŠ¸ì— ìƒí’ˆì„ ë‹´ê±°ë‚˜ ëº„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                                    <p>âœ¨ <strong>ìˆœì„œ ì •ë ¬:</strong><br>ê°œë³„ ë¦¬ìŠ¤íŠ¸ íƒ­ì—ì„œëŠ” ìš°ì¸¡ í•¸ë“¤ì„ ì¡ì•„ ìƒí’ˆì˜ ë…¸ì¶œ ìˆœì„œë¥¼ ììœ ë¡­ê²Œ ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 3. ë¦¬ìŠ¤íŠ¸ ì´ë¦„ ë³€ê²½ -->
                    <div class="accordion-item border-b" id="acc-rename">
                        <div class="accordion-header" onclick="toggleAccordion('acc-rename')">
                            <h4 class="text-sm font-bold text-gray-700"><i class="fas fa-edit text-orange-500 mr-2"></i> ë¦¬ìŠ¤íŠ¸ ì´ë¦„ ë³€ê²½</h4>
                            <i class="fas fa-chevron-down text-gray-400 chevron-icon"></i>
                        </div>
                        <div class="accordion-content">
                            <div class="p-5">
                                <p class="text-[11px] text-gray-400 italic mb-4">í„°ì¹˜í•˜ì—¬ í¬ì»¤ìŠ¤ í›„ ì•„ë˜ í‚¤ì›Œë“œë¥¼ ì„ íƒí•˜ì„¸ìš”.</p>

                                <!-- Custom Inputs with Focus State -->
                                <div class="space-y-2 mb-6">
                                    <div class="list-input-group active" id="group-l1" onclick="focusSettingInput(1)">
                                        <span class="text-xs font-bold text-gray-400 w-8">L1</span>
                                        <input type="text" id="input-l1" placeholder="ë¦¬ìŠ¤íŠ¸1 ì´ë¦„" class="outline-none text-sm w-full bg-transparent" readonly>
                                    </div>
                                    <div class="list-input-group" id="group-l2" onclick="focusSettingInput(2)">
                                        <span class="text-xs font-bold text-gray-400 w-8">L2</span>
                                        <input type="text" id="input-l2" placeholder="ë¦¬ìŠ¤íŠ¸2 ì´ë¦„" class="outline-none text-sm w-full bg-transparent" readonly>
                                    </div>
                                    <div class="list-input-group" id="group-l3" onclick="focusSettingInput(3)">
                                        <span class="text-xs font-bold text-gray-400 w-8">L3</span>
                                        <input type="text" id="input-l3" placeholder="ë¦¬ìŠ¤íŠ¸3 ì´ë¦„" class="outline-none text-sm w-full bg-transparent" readonly>
                                    </div>
                                </div>

                                <!-- Keyword Pool (í•„í„° ì¹©) -->
                                <div class="bg-white rounded-xl p-4 border border-gray-100 shadow-inner h-48 overflow-y-auto mb-6">
                                    <div class="mb-4">
                                        <div class="text-[10px] font-bold text-gray-400 mb-2">ì¶”ì²œ ëª…ì¹­</div>
                                        <div class="flex flex-wrap gap-2">
                                            <button class="keyword-chip" onclick="applyKeyword('ì£¼ë°©')">ì£¼ë°©</button>
                                            <button class="keyword-chip" onclick="applyKeyword('í™€/ë°”')">í™€/ë°”</button>
                                            <button class="keyword-chip" onclick="applyKeyword('ì°½ê³ ')">ì°½ê³ </button>
                                            <button class="keyword-chip" onclick="applyKeyword('ë§¤ì¥')">ë§¤ì¥</button>
                                            <button class="keyword-chip" onclick="applyKeyword('ëƒ‰ì¥ê³ ')">ëƒ‰ì¥ê³ </button>
                                            <button class="keyword-chip" onclick="applyKeyword('ëƒ‰ë™ê³ ')">ëƒ‰ë™ê³ </button>
                                            <button class="keyword-chip" onclick="applyKeyword('ë©”ì¸ì¬ë£Œ')">ë©”ì¸ì¬ë£Œ</button>
                                            <button class="keyword-chip" onclick="applyKeyword('ë¶€ì¬ë£Œ')">ë¶€ì¬ë£Œ</button>
                                            <button class="keyword-chip" onclick="applyKeyword('ì†Œëª¨í’ˆ')">ì†Œëª¨í’ˆ</button>
                                            <button class="keyword-chip" onclick="applyKeyword('ë§¤ì¼ë°œì£¼')">ë§¤ì¼ë°œì£¼</button>
                                            <button class="keyword-chip" onclick="applyKeyword('ì •ê¸°ë°œì£¼')">ì •ê¸°ë°œì£¼</button>
                                        </div>
                                    </div>
                                </div>

                                <button onclick="saveListNames()" class="w-full py-4 bg-gray-800 text-white rounded-xl font-bold text-sm shadow-lg active:scale-95 transition-transform mt-2">ì´ë¦„ ì €ì¥í•˜ê¸°</button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="fixed bottom-0 left-0 right-0 max-w-md mx-auto bg-white border-t z-30 flex h-[60px] safe-pb">
            <button id="footer-search-btn" class="flex-1 flex flex-col items-center justify-center text-gray-500">
                <i class="fas fa-search text-xl mb-0.5"></i><span class="text-[10px]">ê²€ìƒ‰</span>
            </button>
            <button id="footer-cta-btn" class="flex-1 flex flex-col items-center justify-center transition-colors">
                <span class="font-extrabold text-xs text-green-800">ORDERZ</span>
                <span id="cta-text" class="text-sm font-bold text-gray-500">ìƒí’ˆì„ ë‹´ì•„ ì£¼ì„¸ìš”</span>
            </button>
            <button class="flex-1 flex flex-col items-center justify-center text-gray-500">
                <i class="fas fa-comment-dots text-xl mb-0.5"></i><span class="text-[10px]">ë¬¸ì˜</span>
            </button>
        </footer>

    </div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const appState = {
            products: [
                { id: 1, name: 'í™ìª½íŒŒ(1kg)ë‹¨', price: 9800, img: 'https://placehold.co/80/d1e7dd/333333?text=ìª½íŒŒ', category: 'vegetable', liked: true, myList: [], orderCount: 50, likedTimestamp: 1729770000000 },
                { id: 2, name: 'ê¹ì–‘íŒŒ_10kg', price: 19500, img: 'https://placehold.co/80/d1e7dd/333333?text=ì–‘íŒŒ', category: 'vegetable', liked: false, myList: [], orderCount: 120, likedTimestamp: 0 },
                { id: 3, name: 'ë¬´ìš° (ë‚±ê°œ)', price: 2800, img: 'https://placehold.co/80/d1e7dd/333333?text=ë¬´', category: 'vegetable', liked: true, myList: [], orderCount: 30, likedTimestamp: 1729750000000 },
            ],
            cart: {},
            listNames: { 1: 'ë¦¬ìŠ¤íŠ¸1', 2: 'ë¦¬ìŠ¤íŠ¸2', 3: 'ë¦¬ìŠ¤íŠ¸3' },
            currentView: 'home',
            currentMyList: -1,
            currentSort: 'latest',
            startMode: localStorage.getItem('orderz_start_mode') || 'home',
            activeListInputId: 1, // ë¦¬ìŠ¤íŠ¸ ì´ë¦„ ë³€ê²½ ì‹œ ì„ íƒëœ ID
            tempChanges: {}
        };

        // --- Navigation Logic ---
        function switchView(view) {
            appState.currentView = view;
            document.getElementById('home-view').classList.toggle('hidden', view !== 'home');
            document.getElementById('quick-order-view').classList.toggle('hidden', view !== 'quick-order');
            
            const modeText = document.getElementById('mode-text');
            const modeIcon = document.getElementById('mode-icon');
            
            if (view === 'home') {
                modeText.textContent = "ìƒí’ˆëª©ë¡";
                modeIcon.className = "fas fa-bars text-lg text-gray-400";
                renderHomeView();
            } else {
                modeText.textContent = "ì£¼ë¬¸í•˜ê¸°";
                modeIcon.className = "fas fa-clipboard-check text-lg text-green-500";
                renderListTabs();
                renderSubSectionBar();
                renderProducts();
            }
            updateFooterUI();
        }

        document.getElementById('mode-switch-btn').onclick = () => {
            switchView(appState.currentView === 'home' ? 'quick-order' : 'home');
        };

        document.getElementById('header-title').onclick = () => {
            if (appState.currentView !== 'home') switchView('home');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        };

        // --- Settings Modal Logic ---
        window.setStartMode = (mode) => {
            appState.startMode = mode;
            localStorage.setItem('orderz_start_mode', mode);
            updateStartModeUI();
        };

        function updateStartModeUI() {
            const isHome = appState.startMode === 'home';
            document.getElementById('radio-start-home').classList.toggle('active', isHome);
            document.getElementById('radio-start-order').classList.toggle('active', !isHome);
        }

        window.openGuide = () => {
            document.getElementById('guide-modal-overlay').classList.remove('hidden');
            updateStartModeUI();
            document.getElementById('input-l1').value = appState.listNames[1];
            document.getElementById('input-l2').value = appState.listNames[2];
            document.getElementById('input-l3').value = appState.listNames[3];
            focusSettingInput(1);
        };

        window.closeGuide = () => document.getElementById('guide-modal-overlay').classList.add('hidden');

        window.toggleAccordion = (id) => {
            const item = document.getElementById(id);
            item.classList.toggle('active');
        };

        // ì´ë¦„ ë³€ê²½ ì‹œ ì…ë ¥ í•„ë“œ í¬ì»¤ìŠ¤
        window.focusSettingInput = (id) => {
            appState.activeListInputId = id;
            document.querySelectorAll('.list-input-group').forEach(el => el.classList.remove('active'));
            document.getElementById(`group-l${id}`).classList.add('active');
        };

        // í‚¤ì›Œë“œ ì ìš©
        window.applyKeyword = (kw) => {
            const input = document.getElementById(`input-l${appState.activeListInputId}`);
            if (input) input.value = kw;
        };

        window.saveListNames = () => {
            appState.listNames[1] = document.getElementById('input-l1').value || 'ë¦¬ìŠ¤íŠ¸1';
            appState.listNames[2] = document.getElementById('input-l2').value || 'ë¦¬ìŠ¤íŠ¸2';
            appState.listNames[3] = document.getElementById('input-l3').value || 'ë¦¬ìŠ¤íŠ¸3';
            alert('ë¦¬ìŠ¤íŠ¸ ëª…ì¹­ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
            syncTabNames();
            renderListTabs();
        };

        function syncTabNames() {
            [1,2,3].forEach(id => {
                const el = document.getElementById(`cl-tab-l${id}`);
                if(el) el.textContent = appState.listNames[id];
            });
        }

        // --- Rendering Core (Order View) ---
        function renderListTabs() {
            const active = getActiveLists();
            const container = document.getElementById('my-list-tabs');
            const isSp = appState.currentMyList === 0;

            let html = `
                <button class="tab-btn ${isSp?'tab-active':'tab-inactive'}" onclick="switchMainList(0)">
                    <i class="fas fa-star mr-1 ${isSp?'text-yellow-400':'text-gray-300'}"></i>ë‹¨ê³¨íŠ¹ê°€
                </button>
                <button class="tab-btn ${appState.currentMyList===-1?'tab-active':'tab-inactive'}" onclick="switchMainList(-1)">ì°œí•œìƒí’ˆ</button>
            `;
            active.forEach(id => {
                html += `<button class="tab-btn ${appState.currentMyList===id?'tab-active':'tab-inactive'}" onclick="switchMainList(${id})">${appState.listNames[id]}</button>`;
            });
            html += `<div class="flex-grow"></div><button class="add-list-btn-wide ml-2 mr-3" onclick="openCreateListView()">+ ë¦¬ìŠ¤íŠ¸ ë§Œë“¤ê¸°</button>`;
            container.innerHTML = html;
        }

        window.switchMainList = (id) => {
            appState.currentMyList = id;
            renderListTabs();
            renderSubSectionBar();
            renderProducts();
        };

        function renderSubSectionBar() {
            const bar = document.getElementById('sub-section-bar');
            bar.classList.remove('hidden');
            const sortCont = document.querySelector('.sort-dropdown-container');
            sortCont.style.display = (appState.currentMyList === -1) ? 'block' : 'none';
        }

        function renderProducts() {
            const listEl = document.getElementById('product-list');
            let filtered = [];
            if(appState.currentMyList === 0) filtered = appState.products.slice(0,2);
            else if(appState.currentMyList === -1) filtered = appState.products.filter(p => p.liked);
            else filtered = appState.products.filter(p => p.liked && p.myList.includes(appState.currentMyList));

            if (filtered.length === 0) {
                listEl.innerHTML = `<div class="p-20 text-center text-gray-400 text-sm">ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤.</div>`;
                return;
            }

            listEl.innerHTML = filtered.map(p => {
                const qty = appState.cart[p.id] || 0;
                return `
                <div class="flex items-center p-3 border-b ${qty > 0 ? 'bg-green-50' : 'bg-white'}">
                    <img src="${p.img}" class="w-12 h-12 rounded mr-3">
                    <div class="flex-grow">
                        <div class="text-sm font-bold text-gray-800">${p.name}</div>
                        <div class="text-xs text-gray-500">${p.price.toLocaleString()}ì›</div>
                    </div>
                    <div class="flex items-center border rounded-lg bg-white overflow-hidden">
                        <button class="w-8 h-8 hover:bg-gray-50 transition-colors" onclick="updateQty(${p.id},-1)">-</button>
                        <div class="w-8 text-center text-sm font-bold">${qty}</div>
                        <button class="w-8 h-8 hover:bg-gray-50 transition-colors" onclick="updateQty(${p.id},1)">+</button>
                    </div>
                </div>`;
            }).join('');
        }

        window.updateQty = (id, d) => {
            const current = appState.cart[id] || 0;
            const next = Math.max(0, current + d);
            if (next === 0) delete appState.cart[id];
            else appState.cart[id] = next;
            if (next > 0) {
                const p = appState.products.find(x => x.id === id);
                if (p && !p.liked) { p.liked = true; }
            }
            renderProducts();
            updateFooterUI();
        };

        // --- Master/Home Logic ---
        function renderHomeView() {
            const listEl = document.getElementById('home-product-list');
            listEl.innerHTML = appState.products.map(p => `
                <div class="flex items-center p-4 bg-white border-b">
                    <img src="${p.img}" class="w-16 h-16 rounded-lg mr-4">
                    <div class="flex-grow">
                        <div class="font-bold text-sm text-gray-800">${p.name}</div>
                        <div class="text-green-600 font-bold text-base">${p.price.toLocaleString()}ì›</div>
                    </div>
                    <input type="checkbox" class="w-6 h-6 rounded text-green-600 accent-green-600" ${p.liked?'checked':''} onchange="toggleLike(${p.id}, this.checked)">
                </div>
            `).join('');
        }

        window.toggleLike = (id, val) => {
            const p = appState.products.find(x => x.id === id);
            if(p) p.liked = val;
        };

        window.openCreateListView = () => {
            appState.tempChanges = {};
            appState.products.filter(p => p.liked).forEach(p => {
                appState.tempChanges[p.id] = [...(p.myList || [])];
            });
            document.getElementById('create-list-view').classList.remove('hidden');
            renderCreateList();
            syncTabNames();
        };

        function renderCreateList() {
            const itemsEl = document.getElementById('create-list-items');
            const liked = appState.products.filter(p => p.liked);
            if(liked.length === 0) {
                itemsEl.innerHTML = `<div class="p-20 text-center text-gray-400 text-sm">ì°œí•œ ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤.</div>`;
                return;
            }
            itemsEl.innerHTML = liked.map(p => {
                const tags = appState.tempChanges[p.id] || [];
                const getBtn = (num) => `<button class="cl-toggle-btn ${tags.includes(num)?'active':''}" onclick="toggleListTag(${p.id}, ${num})">${num}</button>`;
                return `
                <div class="cl-grid-row">
                    <div class="flex items-center justify-center"><input type="checkbox" class="w-5 h-5 rounded border-gray-300 accent-green-600"></div>
                    <div class="cl-info overflow-hidden pr-2">
                        <div class="text-sm font-bold text-gray-800 truncate">${p.name}</div>
                        <div class="text-xs text-gray-400">${p.price.toLocaleString()}ì›</div>
                    </div>
                    <div>${getBtn(1)}</div><div>${getBtn(2)}</div><div>${getBtn(3)}</div>
                    <div class="text-gray-200 text-center"><i class="fas fa-bars"></i></div>
                </div>`;
            }).join('');
        }

        window.toggleListTag = (pid, lid) => {
            let tags = appState.tempChanges[pid] || [];
            if (tags.includes(lid)) tags = tags.filter(t => t !== lid);
            else tags.push(lid);
            appState.tempChanges[pid] = tags;
            renderCreateList();
        };

        window.saveCreateListChanges = () => {
            Object.entries(appState.tempChanges).forEach(([id, tags]) => {
                const p = appState.products.find(x => x.id == id);
                if (p) p.myList = tags;
            });
            alert('ë¦¬ìŠ¤íŠ¸ êµ¬ì„±ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
            document.getElementById('create-list-view').classList.add('hidden');
            renderListTabs();
            renderProducts();
        };

        window.closeCreateListView = () => document.getElementById('create-list-view').classList.add('hidden');

        function updateFooterUI() {
            const count = Object.values(appState.cart).reduce((a,b)=>a+b, 0);
            const cta = document.getElementById('cta-text');
            const btn = document.getElementById('footer-cta-btn');
            if (appState.currentView === 'home') {
                cta.textContent = "ì£¼ë¬¸í•˜ëŸ¬ ê°€ê¸°";
                cta.className = "text-sm font-bold text-green-600";
                btn.onclick = () => switchView('quick-order');
            } else {
                cta.textContent = count > 0 ? `(${count}) ë‹´ì€ ìƒí’ˆ í™•ì¸` : "ìƒí’ˆì„ ë‹´ì•„ ì£¼ì„¸ìš”";
                cta.className = `text-sm font-bold ${count > 0 ? 'text-green-600' : 'text-gray-400'}`;
                btn.onclick = count > 0 ? () => alert('í™•ì¸') : null;
            }
        }

        function getActiveLists() {
            const activeSet = new Set();
            appState.products.forEach(p => (p.myList || []).forEach(id => activeSet.add(id)));
            return [1, 2, 3].filter(id => activeSet.has(id));
        }

        // Start Up
        switchView(appState.startMode);
    });

    // Dummy Interactions
    window.toggleSortDropdown = (e) => { e.stopPropagation(); document.getElementById('sort-dropdown-menu').classList.toggle('active'); };
    window.changeSort = (s) => { alert(s + ' ì •ë ¬'); document.getElementById('sort-dropdown-menu').classList.remove('active'); };
    window.filterByCategory = (c) => alert(c + ' í•„í„°');
</script>
</body>
</html>
